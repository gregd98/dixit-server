(this["webpackJsonpdixit-client"]=this["webpackJsonpdixit-client"]||[]).push([[0],{42:function(e,t,a){e.exports=a(83)},78:function(e,t){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(14),l=a.n(r),o=a(3),s=a(6),i=function(e,t,a){return new Promise((function(n,c){var r={},l={method:t,credentials:"include"};a&&(l.body=JSON.stringify(a)),fetch(e,l).then((function(e){return r.status=e.status,e.json()})).then((function(e){e.succeed?"GET"===t||e.payload?n(e.payload):n():(r.message=e.message,e.inputErrors&&(r.inputErrors=e.inputErrors),c(r))})).catch((function(e){console.log("Error: ".concat(e.message)),r.message="Failed to connect to the server.",c(r)}))}))},m=function(e){return new Promise((function(t,a){i(e,"GET",null).then((function(e){return t(e)})).catch((function(e){return a(e)}))}))},u=function(e){return new Promise((function(t,a){i(e,"DELETE",null).then((function(e){return t(e)})).catch((function(e){return a(e)}))}))},d=function(e,t){return new Promise((function(a,n){i(e,"PUT",t).then((function(e){return a(e)})).catch((function(e){return n(e)}))}))},f=["#c70039","#511849","#2a7b9b","#57c785","#eddd53","#ff8d1a","#900c3f","#3d3d6b","#00baad","#add45c","#ffc300","#ff5733"],p=function(e){return{type:"LOAD_GAME_DATA",payload:e}},b=function(e){return{type:"LOAD_GAME_TYPE",payload:e}},E=function(e){return{type:"UPDATE_PLAYERS",payload:e}},g=function(e){return{type:"UPDATE_STATE",payload:e}},h=a(8),v=a.n(h),y=a(15),x=a(2),N=a(1),j=a(7),O=a.n(j),w=function(e){var t=e.status,a=e.message;return c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("div",null,c.a.createElement("h1",{className:"text-center text-danger display-4"},"ERROR",t&&" ".concat(t)),c.a.createElement("h4",{className:"text-center text-danger"},a)))},k=function(e){var t=e.id,a=e.text,n=e.btnText,r=e.btnHandler,l=e.errorMessage,o=e.isLoading,s=e.btnType;return s||(s="primary"),c.a.createElement("div",{className:"modal fade",id:t,"data-keyboard":"false",tabIndex:"-1"},c.a.createElement("div",{className:"modal-dialog"},c.a.createElement("div",{className:"modal-content darkBg"},c.a.createElement("div",{className:"modal-body"},c.a.createElement("p",{className:"text-light text-center",style:{fontSize:"1.25rem"}},a),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("button",{onClick:r,type:"button",className:"btn btn-".concat(s),disabled:o},o&&c.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),n),c.a.createElement("button",{type:"button",className:"btn btn-outline-light ml-2","data-bs-dismiss":"modal"},"Cancel")),l&&c.a.createElement("div",{className:"alert alert-danger mt-4 mb-0",role:"alert"},l)))))},S=function(){var e=Object(o.c)((function(e){return e.game.game})),t=Object(n.useState)([]),a=Object(N.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(new Set),i=Object(N.a)(s,2),f=i[0],p=i[1],b=Object(n.useState)({value:0,min:0,max:0}),h=Object(N.a)(b,2),j=h[0],S=h[1],C=Object(n.useState)(""),I=Object(N.a)(C,2),M=I[0],T=I[1],A=Object(n.useState)({rounds:0,turns:0}),P=Object(N.a)(A,2),_=P[0],L=P[1],D=Object(n.useState)(null),W=Object(N.a)(D,2),F=W[0],R=W[1],G=Object(n.useState)(void 0),H=Object(N.a)(G,2),B=H[0],$=H[1],U=Object(n.useState)(!1),V=Object(N.a)(U,2),z=V[0],X=V[1],Y=Object(n.useState)(""),J=Object(N.a)(Y,2),q=J[0],Z=J[1],K=Object(n.useState)({}),Q=Object(N.a)(K,2),ee=Q[0],te=Q[1],ae=Object(n.useState)(!0),ne=Object(N.a)(ae,2),ce=ne[0],re=ne[1],le=Object(n.useState)({text:"",btnHandler:function(){},isLoading:!1,errorMessage:""}),oe=Object(N.a)(le,2),se=oe[0],ie=oe[1],me=Object(o.b)();Object(n.useEffect)((function(){var e=function(){window.$("#exitDialog").modal("hide"),window.$("body").removeClass("modal-open")};return window.onpopstate=e,function(){e(),window.onpopstate=function(){}}}),[]),Object(n.useEffect)((function(){re(!0),m("".concat("/","api/editions")).then((function(e){l(e),re(!1)})).catch((function(e){te(e),re(!1)}))}),[]),Object(n.useEffect)((function(){var e=O()("".concat(window.location.hostname,"/host"));return R(e),function(){e.disconnect(),R(null)}}),[]),Object(n.useEffect)((function(){F&&(F.on("state update",(function(e){me(g(e))})),F.on("player update",(function(e){me(E(e))})))}),[me,F]),Object(n.useEffect)((function(){var t=e.players.length,a=r.reduce((function(e,t){return f.has(t.id)?e+t.cards:e}),0),n=3!==t?5*t+Math.pow(t,2):31;0===t||0===a||a<n?(S((function(e){return Object(x.a)(Object(x.a)({},e),{},{value:0,min:0,max:0})})),a<n&&(0===f.size?T("Select editions!"):T("Not enough cards, select more editions!"))):(S((function(e){return Object(x.a)(Object(x.a)({},e),{},{value:n,min:n,max:a})})),T(""))}),[r,f,e.players.length]),Object(n.useEffect)((function(){var t=j.value,a=e.players.length,n=3===a?7:6,c=3===a?5:a,r=Math.floor((t-a*n)/c+1);L({rounds:r,turns:Math.floor(r/a)})}),[j.value,e.players.length]);var ue=function(e){var t=new Set(f),a=e.id;t.has(a)?t.delete(a):t.add(a),p(t)},de=function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,X(!0),ie((function(e){return Object(x.a)(Object(x.a)({},e),{},{isLoading:!0})})),e.next=5,u("".concat("/","api/games"));case 5:X(!1),me({type:"RESET_GAME"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),X(!1),ie((function(t){return Object(x.a)(Object(x.a)({},t),{},{isLoading:!1,errorMessage:"Error: ".concat(e.t0.message)})}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return ee.message?c.a.createElement(w,{status:ee.status,message:ee.message}):ce?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-center text-light dixit-title"},"Host"),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("div",{className:"list-group edition-list shadow mx-4 darkBg"},r.map((function(e){return c.a.createElement("div",{onClick:function(){return ue(e)},key:e.id,className:"list-group-item d-flex justify-content-between align-items-center clickable darkBg"},c.a.createElement("p",{className:"m-0 p-0 text-light edition-text"},e.name),c.a.createElement("input",{onChange:function(){return ue(e)},className:"form-check-input-lg",type:"checkbox",id:"ch-".concat(e.id),checked:f.has(e.id),disabled:z}))}))),c.a.createElement("div",{className:"mx-4"},c.a.createElement("p",{className:"text-light lobby-text"},"URL: ",c.a.createElement("b",null,e.ip?"http://".concat(e.ip,"/"):"N/A")),c.a.createElement("p",{className:"text-light lobby-text mb-4"},"Code: ",c.a.createElement("b",{className:"code-spacing"},e.code)),e.players.length>=3?c.a.createElement(c.a.Fragment,null,M?c.a.createElement("p",{className:"text-light small-text"},M):c.a.createElement(c.a.Fragment,null,c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{onChange:function(e){var t=e.target.value;S((function(e){return Object(x.a)(Object(x.a)({},e),{},{value:t})}))},min:j.min,max:j.max,type:"range",className:"form-control-range custom-range",id:"inputCardCount",value:j.value,disabled:z})),c.a.createElement("p",{className:"text-light small-roboto mt-4"},"Cards: ",c.a.createElement("b",null,j.value)),c.a.createElement("p",{className:"text-light small-roboto"},"Rounds: ",c.a.createElement("b",null,_.rounds)),c.a.createElement("p",{className:"text-light small-roboto"},"Each player turns: ",c.a.createElement("b",null,_.turns)),c.a.createElement("button",{onClick:function(){X(!0),Z(""),d("".concat("/","api/games/start"),{editions:Array.from(f),cardCount:Number.parseInt(j.value,10)}).catch((function(e){X(!1),Z("Error: ".concat(e.message))}))},className:"btn btn-lg btn-block btn-outline-light mt-4",disabled:z},"Start game",z&&c.a.createElement("span",{className:"spinner-border spinner-border-sm ml-2",role:"status","aria-hidden":"true"})))):c.a.createElement("p",{className:"text-light small-text"},"Waiting players to join."),c.a.createElement("button",{onClick:function(t){return function(e,t){t>0?(e.stopPropagation(),ie({text:"Are you sure you want to exit the lobby?",btnHandler:de,isLoading:!1,errorMessage:""}),window.$("#exitDialog").modal("show")):de()}(t,e.players.length)},className:"btn btn-lg btn-block btn-outline-danger mt-2",disabled:z},"Cancel",z&&c.a.createElement("span",{className:"spinner-border spinner-border-sm ml-2",role:"status","aria-hidden":"true"})),q&&c.a.createElement("div",{className:"alert alert-danger mt-4",role:"alert"},q)),c.a.createElement("div",{className:"list-group edition-list shadow mx-4 darkBg"},e.players.map((function(e,t){return c.a.createElement("div",{key:e.id,onMouseEnter:function(){$(t)},onMouseLeave:function(){B===t&&$(void 0)},className:"list-group-item d-flex justify-content-between align-items-center darkBg"},c.a.createElement("div",{className:"d-flex flex-row"},c.a.createElement("p",{className:"m-0 p-0 text-light edition-text"},e.name),e.isAdmin&&c.a.createElement("span",{className:"badge bg-light rounded-pill text-dark ml-2 align-self-baseline",style:{fontSize:"3mm"}},"admin")),B===t&&c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return t=e.id,void d("".concat("/","api/games/admin"),{playerId:t}).catch((function(e){console.log("Error: ".concat(e.message))}));var t},className:"btn btn-sm btn-outline-secondary mr-2",type:"button",disabled:z},"A"),c.a.createElement("button",{onClick:function(){return t=e.id,void d("".concat("/","api/games/kick"),{playerId:t}).catch((function(e){console.log("Error: ".concat(e.message))}));var t},className:"btn btn-sm btn-outline-danger",type:"button",disabled:z},"X")))})))),c.a.createElement(k,{id:"exitDialog",text:se.text,btnText:"Exit",btnType:"danger",btnHandler:se.btnHandler,isLoading:se.isLoading,errorMessage:se.errorMessage}))},C=a(39),I=a(82),M=function(e){return e.trim()},T=function(e){return e.toUpperCase()},A=function(e){var t=e.type,a=e.id,n=e.label,r=e.state,l=e.setState,o=e.decorators,s=e.constraint,i=e.disabled,m=I({"form-control":!0,"is-invalid":r.error});return c.a.createElement(c.a.Fragment,null,c.a.createElement("label",{htmlFor:a,className:"text-light"},n),c.a.createElement("input",{onChange:function(e){var t=e.target.value;l((function(e){return Object(x.a)(Object(x.a)({},e),{},{value:t,error:""})}))},onBlur:function(){var e=r.value;if(o){for(var t=0;t<o.length;t+=1)e=o[t](e);l((function(t){return Object(x.a)(Object(x.a)({},t),{},{value:e})}))}if(void 0!==s){var a=C({value:e},s,{fullMessages:!1});a&&l((function(e){return Object(x.a)(Object(x.a)({},e),{},{error:a.value[0]})}))}},type:t,className:m,id:a,placeholder:n,value:r.value,disabled:i,step:"any",autoComplete:"off"}),!i&&r.error&&c.a.createElement("div",{className:"invalid-feedback"},r.error))},P={allowEmpty:!1,message:"This field is required."},_={code:{presence:P,format:{pattern:"[A-Z]{6}",message:"Invalid code"}},name:{presence:P,length:{minimum:3,maximum:16,tooShort:"The name must be between 3 and 16 characters.",tooLong:"The name must be between 3 and 16 characters."},format:{pattern:"\\p{L}+",flags:"u",message:"The name must only contain alphabetical characters."}}},L=a(39),D=function(){var e=Object(n.useState)({value:"",error:""}),t=Object(N.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)({value:"",error:""}),s=Object(N.a)(l,2),i=s[0],m=s[1],u=Object(n.useState)(!1),f=Object(N.a)(u,2),E=f[0],g=f[1],h=Object(n.useState)(""),v=Object(N.a)(h,2),y=v[0],j=v[1],O=Object(o.b)(),w={code:r,name:m};return c.a.createElement("div",{className:"d-flex justify-content-center mb-4 mx-4"},c.a.createElement("div",{style:{width:500}},c.a.createElement("p",{className:"text-center text-light dixit-title"},"Join"),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),j("");var t=function(e){Object.entries(e).forEach((function(e){var t=Object(N.a)(e,2),a=t[0],n=t[1];w[a]((function(e){return Object(x.a)(Object(x.a)({},e),{},{error:n[0]})}))}))},n={code:a.value,name:i.value},c=L(n,_,{fullMessages:!1});c?t(c):(g(!0),d("".concat("/","api/player"),n).then((function(e){O(p(e))})).catch((function(e){g(!1),e.inputErrors?t(e.inputErrors):j(e.message)})))},className:"mt-5"},c.a.createElement("div",{className:"form-row"},c.a.createElement("div",{className:"form-group col-md-6"},c.a.createElement(A,{type:"text",id:"inputCode",label:"Code",state:a,setState:r,constraint:{value:_.code},decorators:[M,T],disabled:E})),c.a.createElement("div",{className:"form-group col-md-6"},c.a.createElement(A,{type:"text",id:"inputName",label:"Nickname",state:i,setState:m,constraint:{value:_.name},decorators:[M],disabled:E}))),c.a.createElement("div",{className:"d-flex justify-content-center mt-5"},c.a.createElement("div",null,c.a.createElement("button",{type:"submit",className:"btn btn-lg btn-outline-light mr-1",disabled:E},E&&c.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Join game"),c.a.createElement("button",{onClick:function(){O(b(""))},type:"button",className:"btn btn-lg btn-outline-danger ml-1",disabled:E},"Cancel")))),y&&c.a.createElement("div",{className:"alert alert-danger mt-5",role:"alert"},y)))},W=function(){var e=Object(o.c)((function(e){return e.game.game})),t=Object(o.c)((function(e){return e.game.state})),a=Object(n.useState)(null),r=Object(N.a)(a,2),l=r[0],s=r[1],i=Object(n.useState)(0),m=Object(N.a)(i,2),p=m[0],b=m[1],h=Object(n.useState)([]),v=Object(N.a)(h,2),y=v[0],x=v[1],j=Object(n.useState)([]),w=Object(N.a)(j,2),k=w[0],S=w[1],C=Object(n.useState)([]),I=Object(N.a)(C,2),M=I[0],T=I[1],A=Object(n.useState)(!0),P=Object(N.a)(A,2),_=P[0],L=P[1],D=Object(o.b)(),W=Object(n.useState)(!1),F=Object(N.a)(W,2),R=F[0],G=F[1];Object(n.useEffect)((function(){var e=O()("".concat(window.location.hostname,"/player"));return s(e),function(){e.disconnect(),s(null)}}),[]),Object(n.useEffect)((function(){l&&(l.on("state update",(function(e){D(g(e))})),l.on("player update",(function(e){D(E(e))})),l.on("game deleted",(function(){D({type:"RESET_GAME"})})))}),[D,l]),Object(n.useEffect)((function(){e.players.find((function(t){return t.id===e.playerId}))||D({type:"RESET_GAME"})}),[e.players,e.playerId,D]),Object(n.useEffect)((function(){if(t&&2===t.state&&t.ownCardIndex){for(var a=[],n=3!==e.players.length?e.players.length:5,c=1;c<=n;c+=1)3===e.players.length||e.players.length>=7?t.ownCardIndex.includes(c)||a.push(c):c!==t.ownCardIndex&&a.push(c);x(a)}}),[e.players.length,t]),Object(n.useEffect)((function(){if(t&&(3===t.state||t.isOver)){for(var a=[],n=function(n){var c=e.players[n];a.push({name:c.name,score:t.scores.find((function(e){return e.playerId===c.id})).score})},c=0;c<e.players.length;c+=1)n(c);S(a.sort((function(e,t){return e.score.total>t.score.total?-1:e.score.total<t.score.total?1:e.name<t.name?-1:1})))}}),[e.players,t]),Object(n.useEffect)((function(){return window.$(document).on("slid.bs.carousel","#carouselExampleIndicators",(function(e){b(e.to)})),function(){window.$("#carouselExampleIndicators").unbind()}}),[]),Object(n.useEffect)((function(){var a=e.players.filter((function(e){return e.id!==t.currentPlayer}));switch(t.state){case 2:T(a.map((function(a){return{color:a.color,active:function(){if(e.players.length<7)return t.playersVoted.includes(a.id);var n=t.playersVoted.find((function(e){return e.playerId===a.id}));return!(!n||!n.done)}()}})))}}),[e.players,t]);var H=function(t){var a=e.players.find((function(e){return e.id===t}));return a?a.name:"God"};Object(n.useEffect)((function(){0===t.state&&b(0)}),[t.state]),Object(n.useEffect)((function(){var e=null,a=null,n=function(t){var n=function(e){return e.touches||e.originalEvent.touches}(t)[0];e=n.clientX,a=n.clientY},c=function(t){if(e&&a){var n=t.touches[0].clientX,c=t.touches[0].clientY,r=e-n,l=a-c;Math.abs(r)>Math.abs(l)&&(r>0?window.$("#carouselExampleIndicators").carousel("next"):window.$("#carouselExampleIndicators").carousel("prev")),e=null,a=null}};return t.isStarted&&(document.addEventListener("touchstart",n,!1),document.addEventListener("touchmove",c,!1)),function(){document.removeEventListener("touchstart",n,!1),document.removeEventListener("touchmove",c,!1)}}),[t.isStarted]),Object(n.useEffect)((function(){2===t.state&&(L(!0),setTimeout((function(){L(!1)}),2e3))}),[t.state]);var B=function(){G(!0),d("".concat("/","api/games/pick"),{pickedCard:t.hand[p].id}).then((function(e){D(g(e)),G(!1)})).catch((function(e){G(!1),console.log("Error: ".concat(e.message))}))},$=function(){G(!0),d("".concat("/","api/games/vote"),{vote:"done"}).then((function(e){D(g(e)),G(!1)})).catch((function(e){G(!1),console.log("Error: ".concat(e.message))}))},U=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center small-text p-0 my-2"},"Other players voting."),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},M.map((function(e,t){return c.a.createElement("div",{key:t,className:"vote-circle-lg m-1 moving-circle rounded-circle mx-2 shadow".concat(e.active?" move-circle":""),style:{backgroundColor:f[e.color]}})}))))},V=function(e,a){return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center small-text p-0 my-2"},a),c.a.createElement("div",{id:"carouselExampleIndicators",className:"carousel slide","data-bs-ride":"carousel","data-bs-interval":!1,"data-bs-touch":!1},c.a.createElement("ol",{className:"carousel-indicators"},t.hand.map((function(e,t){return a=t,c.a.createElement(c.a.Fragment,{key:a},a===p?c.a.createElement("li",{"data-bs-target":"#carouselExampleIndicators",className:"active","data-bs-slide-to":a}):c.a.createElement("li",{"data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":a}));var a}))),c.a.createElement("div",{className:"carousel-inner"},t.hand.map((function(e,t){return a=e.fileName,n=t,c.a.createElement("div",{className:"carousel-item".concat(n===p?" active":""),key:n},c.a.createElement("img",{src:"".concat("/","cards/").concat(a),className:"d-block w-100",alt:a}));var a,n}))),c.a.createElement("a",{className:"carousel-control-prev",href:"#carouselExampleIndicators",role:"button","data-bs-slide":"prev"},c.a.createElement("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),c.a.createElement("span",{className:"sr-only"},"Previous")),c.a.createElement("a",{className:"carousel-control-next",href:"#carouselExampleIndicators",role:"button","data-bs-slide":"next"},c.a.createElement("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),c.a.createElement("span",{className:"sr-only"},"Next")),e&&c.a.createElement("button",{id:"btn_pick",className:"pick",onClick:B,disabled:R},"Pick this card")))};if(t.isStarted&&!t.isOver){var z=e.playerId===t.currentPlayer;switch(t.state){case 0:return z?V(!0,"Your turn!"):V(!1,"Waiting for ".concat(H(t.currentPlayer),"."));case 1:if(z)return V(!1,"Waiting for other players.");if(3!==e.players.length){if(t.playersPicked.includes(e.playerId))return V(!1,"Waiting for other players.")}else{var X=t.playersPicked.find((function(t){return t.playerId===e.playerId}));if(X)return X.both?V(!1,"Waiting for other players."):V(!0,"Pick another card to ".concat(H(t.currentPlayer),"'s sentence."))}return V(!0,"Pick a card to ".concat(H(t.currentPlayer),"'s sentence."));case 2:if(!z&&_)return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center small-text p-0 mt-2"},"Voting"),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("div",{className:"spinner-grow text-light vote-loading",role:"status"})));if(e.players.length>=7){var Y=t.playersVoted.find((function(t){return t.playerId===e.playerId}));if(z||Y&&Y.done)return U()}else if(z||t.playersVoted.includes(e.playerId))return U();return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center small-text p-0 mt-2"},"Voting"),c.a.createElement("div",{className:"d-grid gap-2 mx-2 mt-2"},y.map((function(e){return c.a.createElement("button",{key:e,onClick:function(){return function(e){G(!0),d("".concat("/","api/games/vote"),{vote:e}).then((function(e){D(g(e)),G(!1)})).catch((function(e){G(!1),console.log("Error: ".concat(e.message))}))}(e)},className:"btn btn-lg btn-outline-light btn-block",type:"button",disabled:R},e)})),function(){if(2===t.state&&e.players.length>=7){var a=t.playersVoted.find((function(t){return t.playerId===e.playerId}));return a&&!a.done}return!1}()&&c.a.createElement("button",{onClick:$,className:"btn btn-lg btn-outline-light btn-block mt-4",disabled:R},"Done")));case 3:return c.a.createElement(c.a.Fragment,null,e.players.find((function(t){return t.id===e.playerId&&t.isAdmin}))&&c.a.createElement("div",{className:"mx-2 mt-4"},c.a.createElement("button",{className:"btn btn-block btn-lg btn-outline-light",onClick:function(){G(!0),d("".concat("/","api/games/next"),{}).then((function(e){D(g(e)),G(!1)})).catch((function(e){G(!1),console.log("Error: ".concat(e.message))}))},disabled:R},"Next")),c.a.createElement("div",{className:"d-flex justify-content-center my-4"},c.a.createElement("div",{className:"card darkBg mx-4 shadow",style:{width:"280px",maxWidth:"280px",minWidth:"280px"}},c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"d-flex justify-content-center mb-4 mt-2"},c.a.createElement("img",{src:"".concat("/","coup.png"),alt:"coup",style:{maxWidth:"80px"}})),k.map((function(e){return c.a.createElement("div",{key:e.name,className:"d-flex flex-row p-0 m-0 mr-2"},c.a.createElement("div",{className:"col-7 p-0 m-0"},c.a.createElement("p",{className:"text-light score-text nowrap"},e.name)),c.a.createElement("div",{className:"d-flex justify-content-start col-5 p-0 m-0 ml-2"},c.a.createElement("p",{className:"text-light score-text"},c.a.createElement("b",null,e.score.total)),e.score.lastRound>0&&c.a.createElement("p",{className:"text-light score-small-text ml-2"},"+",e.score.lastRound)))}))))));default:return c.a.createElement("h1",null,"Error")}}return t.isOver?c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center small-text p-0 mt-2"},"Game Over"),c.a.createElement("div",{className:"d-flex justify-content-center my-4"},c.a.createElement("div",{className:"card darkBg mx-4 shadow",style:{width:"280px",maxWidth:"280px",minWidth:"280px"}},c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"d-flex justify-content-center mb-4 mt-2"},c.a.createElement("img",{src:"".concat("/","coup.png"),alt:"coup",style:{maxWidth:"80px"}})),k.map((function(e){return c.a.createElement("div",{key:e.name,className:"d-flex flex-row p-0 m-0 mr-2"},c.a.createElement("div",{className:"col-10 p-0 m-0"},c.a.createElement("p",{className:"text-light score-text nowrap"},e.name)),c.a.createElement("div",{className:"d-flex justify-content-start col-2 p-0 m-0 ml-2"},c.a.createElement("p",{className:"text-light score-text"},c.a.createElement("b",null,e.score.total))))}))))),e.players.find((function(t){return t.id===e.playerId&&t.isAdmin}))&&c.a.createElement("div",{className:"mx-2 mt-4"},c.a.createElement("button",{className:"btn btn-block btn-lg btn-outline-light",onClick:function(){d("".concat("/","api/games/reset"),{}).then((function(e){D(g(e))})).catch((function(e){console.log("Error: ".concat(e.message))}))},disabled:R},"Return to lobby"),c.a.createElement("button",{className:"btn btn-block btn-lg btn-outline-danger",onClick:function(){u("".concat("/","api/games")).then((function(){D({type:"RESET_GAME"})})).catch((function(e){console.log("Error: ".concat(e.message))}))},disabled:R},"Exit"))):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"text-light text-center medium-text p-0 mt-4"},"Waiting to start"),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("button",{onClick:function(){d("".concat("/","api/games/kick"),{}).catch((function(e){console.log("Error: ".concat(e.message))}))},className:"btn btn-lg btn-outline-danger"},"Exit")))},F=function(){var e=Object(o.c)((function(e){return e.game.game})),t=Object(o.c)((function(e){return e.game.state})),a=Object(n.useState)(0),r=Object(N.a)(a,2),l=r[0],s=r[1];return Object(n.useEffect)((function(){var t=function(){var t=e.players.length;if(t>0){var a=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);s((a-16*t)/t)}};return t(),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e.players.length]),c.a.createElement("div",{style:{height:"60px",maxHeight:"60px"},className:"d-flex justify-content-center flex-wrap"},e.players.map((function(e){return c.a.createElement("div",{key:e.id,className:"d-flex flex-row my-2 mx-1 px-1 card shadow darkBg".concat(e.id===t.currentPlayer?" border-warning":""),style:{maxWidth:"".concat(l,"px")}},c.a.createElement("div",{className:"vote-circle-lg m-1 rounded-circle my-auto",style:{backgroundColor:f[e.color]}}),c.a.createElement("p",{className:"text-light my-auto mx-1 user-name nowrap"},e.name))})))},R=function(){var e=Object(o.c)((function(e){return e.game.game})),t=Object(o.c)((function(e){return e.game.state})),a=Object(n.useState)(null),r=Object(N.a)(a,2),l=r[0],s=r[1],i=Object(n.useState)([]),d=Object(N.a)(i,2),b=d[0],h=d[1],j=Object(n.useState)(0),w=Object(N.a)(j,2),S=w[0],C=w[1],I=Object(n.useState)(0),M=Object(N.a)(I,2),T=M[0],A=M[1],P=Object(n.useState)([]),_=Object(N.a)(P,2),L=_[0],D=_[1],W=Object(n.useState)({text:"",btnHandler:function(){},isLoading:!1,errorMessage:""}),R=Object(N.a)(W,2),G=R[0],H=R[1],B=Object(o.b)();Object(n.useEffect)((function(){var e=function(){window.$("#exitDialog").modal("hide"),window.$("body").removeClass("modal-open")};return window.onpopstate=e,function(){e(),window.onpopstate=function(){}}}),[]),Object(n.useEffect)((function(){m("".concat("/","api/games")).then((function(e){e.game&&B(p(e))})).catch((function(e){console.log("Error: ".concat(e.message))}))}),[B]),Object(n.useEffect)((function(){var e=O()("".concat(window.location.hostname,"/host"));return s(e),function(){e.disconnect(),s(null)}}),[]),Object(n.useEffect)((function(){l&&(l.on("state update",(function(e){B(g(e))})),l.on("player update",(function(e){B(E(e))})),l.on("game deleted",(function(){B({type:"RESET_GAME"})})))}),[B,l]),Object(n.useEffect)((function(){if(t){for(var a=[],n=function(n){var c=e.players[n];a.push({name:c.name,score:t.scores.find((function(e){return e.playerId===c.id})).score})},c=0;c<e.players.length;c+=1)n(c);h(a.sort((function(e,t){return e.score.total>t.score.total?-1:e.score.total<t.score.total?1:e.name<t.name?-1:1})))}}),[e.players,t]),Object(n.useEffect)((function(){var t=function(){var t=3!==e.players.length?e.players.length:5;if(t>0){var a=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),n=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),c=Math.ceil(a-16-60),r=Math.ceil((n-16*t)/t);r<250&&(r=Math.ceil((n-8*t)/(t+(t%2===0?0:1))*2),c=Math.ceil(.5*(a-16-60))),A(r),C(c)}};return t(),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e.players.length]),Object(n.useEffect)((function(){var a=e.players.filter((function(e){return e.id!==t.currentPlayer}));switch(t.state){case 0:D([{color:e.players.find((function(e){return e.id===t.currentPlayer})).color,active:!1}]);break;case 1:3!==e.players.length?D(a.map((function(e){return{color:e.color,active:t.playersPicked.includes(e.id)}}))):D(a.reduce((function(e,a){var n=a.color,c=t.playersPicked.find((function(e){return e.playerId===a.id}));return e.push({color:n,active:!!c},{color:n,active:!!c&&c.both}),e}),[]))}}),[e.players,t]);var $=function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,H((function(e){return Object(x.a)(Object(x.a)({},e),{},{isLoading:!0})})),e.next=4,u("".concat("/","api/games"));case 4:B({type:"RESET_GAME"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),H((function(t){return Object(x.a)(Object(x.a)({},t),{},{isLoading:!1,errorMessage:"Error: ".concat(e.t0.message)})}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),U=function(e){e.stopPropagation(),H({text:"Are you sure you want to exit the game?",btnHandler:$,isLoading:!1,errorMessage:""}),window.$("#exitDialog").modal("show")},V=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("nav",{className:"navbar navbar-light fixed-top mt-2 p-0 mr-2",style:{background:"transparent"}},c.a.createElement("span",null),c.a.createElement("span",{onClick:U,className:"material-icons text-danger exit-icon clickable float-right p-0 mr-2 mt-2"},"close")),e,c.a.createElement(k,{id:"exitDialog",text:G.text,btnText:"Exit",btnType:"danger",btnHandler:G.btnHandler,isLoading:G.isLoading,errorMessage:G.errorMessage}))},z=function(t){var a=e.players.find((function(e){return e.id===t}));return a?a.name:"God"},X=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(F,null),c.a.createElement("div",{className:"d-flex justify-content-center flex-wrap m-0"},t.table.map((function(a,n){return c.a.createElement("div",{key:a.id,className:"card m-1 p-0 shadow rounded-lg darkBg border-0"},c.a.createElement("img",{src:"".concat("/","cards/").concat(a.fileName),className:"card-img-top table-card rounded-lg",alt:"faszom",style:{maxHeight:"".concat(S,"px"),maxWidth:"".concat(T,"px")}}),c.a.createElement("p",{id:"btn_pick",className:"pick vote-num".concat(3===t.state?" vote-num-left":"")},n+1),3===t.state&&c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{id:"btn_pick",className:"pick vote-name".concat(a.id===t.originalCardId?" vote-name-original":"")},(r=a.id)===t.originalCardId?e.players.find((function(e){return e.id===t.currentPlayer})).name:3!==e.players.length?e.players.find((function(e){return e.id===t.playersPicked.find((function(e){return r===e.card.id})).playerId})).name:e.players.find((function(e){return e.id===t.playersPicked.find((function(e){return!!e.cards.find((function(e){return e.id===r}))})).playerId})).name),function(a){var n;return n=e.players.length<7?t.votes.filter((function(e){return e.vote===a})):t.votes.filter((function(e){return e.votes.includes(a)})),c.a.createElement(c.a.Fragment,null,n.length>0&&c.a.createElement("div",{id:"btn_pick",className:"bottom-votes d-flex flex-wrap m-0 px-2 py-2"},n.map((function(t){return e.players.find((function(e){return e.id===t.playerId})).color})).map((function(e){return c.a.createElement("div",{key:e,className:"vote-circle m-1 rounded-circle",style:{backgroundColor:f[e]}})}))))}(n+1)));var r}))))};if(t.isOver)return V(c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},c.a.createElement("div",null,c.a.createElement("p",{className:"text-light big-text text-center"},"Game Over"),c.a.createElement("div",{className:"card darkBg mx-4 shadow mt-4",style:{width:"280px",maxWidth:"280px",minWidth:"280px"}},c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"d-flex justify-content-center mb-4 mt-2"},c.a.createElement("img",{className:"coup-image",src:"".concat("/","coup.png"),alt:"coup"})),b.map((function(e){return c.a.createElement("div",{key:e.name,className:"d-flex flex-row p-0 m-0 mr-2"},c.a.createElement("div",{className:"col-10 p-0 m-0"},c.a.createElement("p",{key:e.name,className:"text-light score-text nowrap"},e.name)),c.a.createElement("div",{className:"d-flex justify-content-start col-2 p-0 m-0 ml-2"},c.a.createElement("p",{key:e.name,className:"text-light score-text"},c.a.createElement("b",null,e.score.total))))})))))));switch(t.state){case 0:case 1:return V(c.a.createElement(c.a.Fragment,null,c.a.createElement(F,{className:"mb-3"}),c.a.createElement("div",{className:"d-flex justify-content-around mt-5"},c.a.createElement("div",{className:"mx-4"},t.state<2&&c.a.createElement(c.a.Fragment,null,0===t.state?c.a.createElement("p",{className:"text-light big-text"},"Waiting for ",c.a.createElement("b",null,z(t.currentPlayer)),", to pick a card."):c.a.createElement("p",{className:"text-light big-text"},"Pick a card to ",c.a.createElement("b",null,z(t.currentPlayer)),"'s sentence"),c.a.createElement("div",{className:"d-flex justify-content-center mt-4"},L.map((function(e,t){return c.a.createElement("div",{key:t,className:"vote-circle-lg m-1 moving-circle rounded-circle mx-2 shadow".concat(e.active?" move-circle":""),style:{backgroundColor:f[e.color]}})}))))),c.a.createElement("div",null,c.a.createElement("p",{className:"text-light round-counter-text text-center"},"Turns: ",c.a.createElement("b",null,t.rounds.current,"/",t.rounds.total)),c.a.createElement("div",{className:"card darkBg mx-4 shadow",style:{width:"280px",maxWidth:"280px",minWidth:"280px"}},c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"d-flex justify-content-center mb-4 mt-2"},c.a.createElement("img",{className:"coup-image",src:"".concat("/","coup.png"),alt:"coup"})),b.map((function(e){return c.a.createElement("div",{key:e.name,className:"d-flex flex-row p-0 m-0 mr-2"},c.a.createElement("div",{className:"col-10 p-0 m-0"},c.a.createElement("p",{key:e.name,className:"text-light score-text nowrap"},e.name)),c.a.createElement("div",{className:"d-flex justify-content-start col-2 p-0 m-0 ml-2"},c.a.createElement("p",{key:e.name,className:"text-light score-text"},c.a.createElement("b",null,e.score.total))))}))))))));case 2:case 3:return V(X());default:return c.a.createElement("h1",null,"Error")}};var G=function(){var e=Object(o.c)((function(e){return e.game.game.type})),t=Object(o.c)((function(e){return e.game.game.code})),a=Object(o.c)((function(e){return e.game.state.isStarted})),r=Object(o.b)();return Object(n.useEffect)((function(){m("".concat("/","api/games")).then((function(e){e.game?r(p(e)):r({type:"RESET_GAME"})})).catch((function(e){console.log("Error: ".concat(e.message))}))}),[r]),e?"host"===e?a?c.a.createElement(R,null):c.a.createElement(S,null):t?c.a.createElement(W,null):c.a.createElement(D,null):c.a.createElement("div",null,c.a.createElement("p",{className:"dixit-title text-light text-center"},"DiXit"),c.a.createElement("div",{className:"d-flex justify-content-center"},c.a.createElement("button",{onClick:function(){d("".concat("/","api/games")).then((function(e){e.game?r(p(e)):r({type:"RESET_GAME"})})).catch((function(e){console.log("Error: ".concat(e.message))}))},className:"btn btn-lg btn-outline-light mt-2 mr-2"},"Host game"),c.a.createElement("button",{onClick:function(){r(b("player"))},className:"btn btn-lg btn-outline-light mt-2 ml-2"},"Join game")))},H=a(9),B={game:{type:"",code:"",players:[]},state:{}},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_GAME_DATA":return Object(H.a)(e,(function(e){e.game=t.payload.game,e.state=t.payload.state}));case"LOAD_GAME_TYPE":return Object(H.a)(e,(function(e){e.game.type=t.payload}));case"UPDATE_PLAYERS":return Object(H.a)(e,(function(e){e.game.players=t.payload}));case"UPDATE_STATE":return Object(H.a)(e,(function(e){e.state=t.payload}));case"RESET_GAME":return B;default:return e}},U=Object(s.b)({game:$}),V=Object(s.c)(U,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(o.a,{store:V},c.a.createElement(G,null))),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.d1e4c6a8.chunk.js.map